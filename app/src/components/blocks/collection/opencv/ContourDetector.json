{"editor":{"id":"a66df9f4-9ab7-4ca5-bfd1-46f974aac09b","offsetX":0,"offsetY":0,"zoom":100,"gridSize":0,"layers":[{"id":"eafb035a-af6a-4309-9f2c-839fd3329de4","type":"diagram-links","isSvg":true,"transformed":true,"models":{"73b5fb62-3b27-447a-a60f-658086cbd36a":{"id":"73b5fb62-3b27-447a-a60f-658086cbd36a","type":"default","selected":false,"source":"0001-57aefee0-1ea8-4639-9a30-8c2bf9636454","sourcePort":"0c0b0ed1-8b70-469b-a475-96959fb8693f","target":"7672c15b-5402-4746-b962-568ac33a0b33","targetPort":"e3b45078-56e3-462f-b1cc-7aaab22623d1","points":[{"id":"38046bee-5d97-490a-a46d-bc7c7f763f5b","type":"point","x":723,"y":128.6999969482422},{"id":"77e192c9-b741-4608-897a-71fff2a64f52","type":"point","x":716.3250122070312,"y":180.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"433041f5-22c9-4455-aad7-9f682d6e1b2f":{"id":"433041f5-22c9-4455-aad7-9f682d6e1b2f","type":"default","selected":false,"source":"836f0850-4f43-4c8b-bd4a-96e25fd7f953","sourcePort":"02b9053d-44cd-4b99-93f1-c8e724b3ca97","target":"7672c15b-5402-4746-b962-568ac33a0b33","targetPort":"5c4005e4-5124-4b41-8ec7-47b05e5a38f5","points":[{"id":"15d13478-1c22-44a1-8a42-7fb58e38b42b","type":"point","x":279.5,"y":321.6000061035156},{"id":"a21cf0a6-505b-4f2f-a597-b2d9b436e9bf","type":"point","x":388.5,"y":324.82501220703125}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"f1fdb76b-f125-4a00-91b5-fbc7fe31d462":{"id":"f1fdb76b-f125-4a00-91b5-fbc7fe31d462","type":"default","selected":false,"source":"9da6d683-2099-4b74-9be8-f90e02ae31a6","sourcePort":"aefa44e5-7a4f-43f2-87ef-86b4e9e71051","target":"7672c15b-5402-4746-b962-568ac33a0b33","targetPort":"b4ab1a52-b84f-4f0a-a650-89f02614e519","points":[{"id":"8d41cc81-fb6e-4d43-af56-0698431afddd","type":"point","x":281.5,"y":469.60003662109375},{"id":"3dd3e8f2-88c0-4029-bf85-55d1781179c7","type":"point","x":388.5,"y":469.1500244140625}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"e757639c-4da1-431b-aae4-a4d07c04cef5":{"id":"e757639c-4da1-431b-aae4-a4d07c04cef5","type":"default","selected":false,"source":"7672c15b-5402-4746-b962-568ac33a0b33","sourcePort":"2c8156d4-99a3-4121-8954-3ca648b84fcd","target":"d29b38a8-e56b-4ee1-8eb5-acb85e19be79","targetPort":"2e0a37f7-cc0e-48d5-a176-8dbe949a8f40","points":[{"id":"c9e7283c-35c0-460b-8781-b3ca22f00d6c","type":"point","x":1044.1624755859375,"y":397},{"id":"678fa801-ebdf-4818-9d0b-d124c5851c75","type":"point","x":1135.5,"y":398.6000061035156}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"}}},{"id":"f2046555-f3db-484a-ac3c-b67e0b253677","type":"diagram-nodes","isSvg":false,"transformed":true,"models":{"0001-57aefee0-1ea8-4639-9a30-8c2bf9636454":{"id":"0001-57aefee0-1ea8-4639-9a30-8c2bf9636454","type":"basic.constant","selected":false,"x":662,"y":13,"ports":[{"id":"0c0b0ed1-8b70-469b-a475-96959fb8693f","type":"port.output","x":715.5,"y":121.19999694824219,"name":"constant-out","alignment":"bottom","parentNode":"0001-57aefee0-1ea8-4639-9a30-8c2bf9636454","links":["73b5fb62-3b27-447a-a60f-658086cbd36a"],"in":false,"label":"constant-out","hideLabel":true}],"data":{"name":"Frequency","value":"30.0","local":true}},"7672c15b-5402-4746-b962-568ac33a0b33":{"id":"7672c15b-5402-4746-b962-568ac33a0b33","type":"basic.code","selected":false,"x":380,"y":172,"ports":[{"id":"5c4005e4-5124-4b41-8ec7-47b05e5a38f5","type":"port.input","x":381,"y":317.32501220703125,"name":"Inp","alignment":"left","parentNode":"7672c15b-5402-4746-b962-568ac33a0b33","links":["433041f5-22c9-4455-aad7-9f682d6e1b2f"],"in":true,"label":"Inp","hideLabel":false},{"id":"b4ab1a52-b84f-4f0a-a650-89f02614e519","type":"port.input","x":381,"y":461.6500244140625,"name":"E","alignment":"left","parentNode":"7672c15b-5402-4746-b962-568ac33a0b33","links":["f1fdb76b-f125-4a00-91b5-fbc7fe31d462"],"in":true,"label":"E","hideLabel":false},{"id":"2c8156d4-99a3-4121-8954-3ca648b84fcd","type":"port.output","x":1036.6624755859375,"y":389.5,"name":"Out","alignment":"right","parentNode":"7672c15b-5402-4746-b962-568ac33a0b33","links":["e757639c-4da1-431b-aae4-a4d07c04cef5"],"in":false,"label":"Out","hideLabel":false},{"id":"e3b45078-56e3-462f-b1cc-7aaab22623d1","type":"port.parameter","x":708.8250122070312,"y":173,"name":"Frequency","alignment":"top","parentNode":"7672c15b-5402-4746-b962-568ac33a0b33","links":["73b5fb62-3b27-447a-a60f-658086cbd36a"],"in":true,"label":"Frequency","hideLabel":false}],"data":{"code":"import cv2 as cv\nimport numpy as np\nfrom time import sleep\nfrom utils.wires.wire_img import share_image, read_image\nfrom utils.wires.wire_str import read_string\nfrom utils.tools.freq_monitor import monitor_frequency\n\ndef loop(block_name, input_wires, output_wires, parameters, flags):\n\n    input_0 = read_image(input_wires[0])\n    output_0 = share_image(output_wires[0])\n\n    enabled = False\n    try:\n        enable_wire = read_string(input_wires[1])\n    except IndexError:\n        enabled = True\n    \n    required_frequency, update = float(parameters[0]), 1\n    control_data = np.array([0.0,0.03])\n    \n    if flags[0] == 1:\n        monitor_frequency(block_name, control_data, required_frequency, update)\n        \n    try:\n    \n        while True:\n        \n            if enabled or (update := bool(enable_wire.get()[0])):\n\n                img = input_0.get()\n        \n                if img is not None:\n        \n                    img2 = cv.cvtColor(img, cv.COLOR_BGR2GRAY)\n                    ret, thresh = cv.threshold(img2,60,255,cv.THRESH_BINARY)\n                    contours, hierarchy = cv.findContours(thresh, 1, 2)\n            \n                    # Find the biggest contour (if detected)\n                    if len(contours) > 0:\n                    \n                        cnt = max(contours, key=cv.contourArea)\n                        rect = cv.minAreaRect(cnt) # ( center (x,y), (width, height), angle of rotation )\n                        \n                        M = cv.moments(cnt)\n                        cx = int(M['m10']/M['m00'])\n                        cy = int(M['m01']/M['m00'])\n                        \n                        data = [cx, cy, rect[1][0], rect[1][1], rect[2]]\n                        to_write = np.array(data, dtype='<U6')\n                        \n                        # (x, y, width, height, angle of rotation)\n                        output_0.add(to_write)\n            \n                    control_data[0] += 1\n                        \n            sleep(control_data[1])\n            \n    except KeyboardInterrupt: \n    \n        input_0.release()\n        enable_wire.release()\n        output_0.release()","params":[{"name":"Frequency"}],"ports":{"in":[{"name":"Inp"},{"name":"E"}],"out":[{"name":"Out"}]},"size":{"width":"624px","height":"386px"}}},"836f0850-4f43-4c8b-bd4a-96e25fd7f953":{"id":"836f0850-4f43-4c8b-bd4a-96e25fd7f953","type":"basic.input","selected":false,"x":186,"y":295,"ports":[{"id":"02b9053d-44cd-4b99-93f1-c8e724b3ca97","type":"port.output","x":272,"y":314.1000061035156,"name":"input-out","alignment":"right","parentNode":"836f0850-4f43-4c8b-bd4a-96e25fd7f953","links":["433041f5-22c9-4455-aad7-9f682d6e1b2f"],"in":false,"label":"input-out","hideLabel":true}],"data":{"name":"Inp"}},"9da6d683-2099-4b74-9be8-f90e02ae31a6":{"id":"9da6d683-2099-4b74-9be8-f90e02ae31a6","type":"basic.input","selected":false,"x":188,"y":443,"ports":[{"id":"aefa44e5-7a4f-43f2-87ef-86b4e9e71051","type":"port.output","x":274,"y":462.10003662109375,"name":"input-out","alignment":"right","parentNode":"9da6d683-2099-4b74-9be8-f90e02ae31a6","links":["f1fdb76b-f125-4a00-91b5-fbc7fe31d462"],"in":false,"label":"input-out","hideLabel":true}],"data":{"name":"E"}},"d29b38a8-e56b-4ee1-8eb5-acb85e19be79":{"id":"d29b38a8-e56b-4ee1-8eb5-acb85e19be79","type":"basic.output","selected":false,"x":1127,"y":372,"ports":[{"id":"2e0a37f7-cc0e-48d5-a176-8dbe949a8f40","type":"port.input","x":1128,"y":391.1000061035156,"name":"output-in","alignment":"left","parentNode":"d29b38a8-e56b-4ee1-8eb5-acb85e19be79","links":["e757639c-4da1-431b-aae4-a4d07c04cef5"],"in":true,"label":"output-in","hideLabel":true}],"data":{"name":"Out"}}}}]},"version":"3.0","package":{"name":"ContourDetector","version":"1.0.0","description":"Draws Contours in an Image.","author":"Muhammad Taha Suhail","image":"data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNTEyIDUxMiIgaGVpZ2h0PSI1MTIiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnPjxnPjxwYXRoIGQ9Im00OTcgMjQxaC0yOS42OGMtNy4zNy0xMDQuODgtOTEuNDQtMTg4Ljk0LTE5Ni4zMi0xOTYuMzJ2LTI5LjY4YzAtOC4yOC02LjcyLTE1LTE1LTE1cy0xNSA2LjcyLTE1IDE1djI5LjY4Yy0xMDQuODggNy4zOC0xODguOTUgOTEuNDQtMTk2LjMyIDE5Ni4zMmgtMjkuNjhjLTguMjggMC0xNSA2LjcyLTE1IDE1IDAgOC4yOSA2LjcyIDE1IDE1IDE1aDI5LjY4YzcuMzcgMTA0Ljg4IDkxLjQ0IDE4OC45NSAxOTYuMzIgMTk2LjMydjI5LjY4YzAgOC4yOSA2LjcyIDE1IDE1IDE1czE1LTYuNzEgMTUtMTV2LTI5LjY4YzEwNC44OC03LjM3IDE4OC45NS05MS40NCAxOTYuMzItMTk2LjMyaDI5LjY4YzguMjggMCAxNS02LjcxIDE1LTE1IDAtOC4yOC02LjcyLTE1LTE1LTE1em0tMjQxIDE5Ni44NGMtMTAwLjI3IDAtMTgxLjg0LTgxLjU3LTE4MS44NC0xODEuODRzODEuNTctMTgxLjg0IDE4MS44NC0xODEuODQgMTgxLjg0IDgxLjU3IDE4MS44NCAxODEuODQtODEuNTcgMTgxLjg0LTE4MS44NCAxODEuODR6IiBmaWxsPSIjNDU0NTU0Ii8+PC9nPjxwYXRoIGQ9Im0zNTUuMTIgMTkzLjkxLTk5LjEyIDE1MC42NS05OS4wOS0xNTAuNjljMS4wOC0xLjcyIDIuNTEtMy4yMyA0LjIyLTQuNGw4Ni43MS01OS40YzIuNDYtMS42OSA1LjMtMi41NyA4LjE2LTIuNjIgMy4wOC0uMDcgNi4xOC44MiA4LjgzIDIuNjVsODYuMDQgNTkuMzdjMS43MiAxLjE4IDMuMTYgMi43IDQuMjUgNC40NHoiIGZpbGw9IiNmZmYxNmIiLz48cGF0aCBkPSJtMzU1LjEyIDE5My45MS05OS4xMiAxNTAuNjV2LTIxNy4xMWMzLjA4LS4wNyA2LjE4LjgyIDguODMgMi42NWw4Ni4wNCA1OS4zN2MxLjcyIDEuMTggMy4xNiAyLjcgNC4yNSA0LjQ0eiIgZmlsbD0iI2ZmZDg0NSIvPjxwYXRoIGQ9Im0yNTYgMjU2IDIwIDYxLjU1Ni0yMCA2Ny4wMDRjLTIuOTcgMC01LjkzLS44OS04LjQ4LTIuNjNsLTg2LjM3LTU5LjE3Yy00LjA4LTIuNzktNi41Mi03LjQyLTYuNTItMTIuMzd2LTEwOC41NmMwLTIuODcuODItNS42MiAyLjI4LTcuOTZ6IiBmaWxsPSIjZmZkODQ1Ii8+PHBhdGggZD0ibTM1Ny4zNyAyMDEuODN2MTA4LjU2YzAgNC45NS0yLjQ0IDkuNTgtNi41MiAxMi4zN2wtODYuMzcgNTkuMTdjLS4wMS4wMS0uMDEuMDEtLjAxLjAxLS40Ny4zMi0uOTYuNjItMS40OC44OS0yLjE5IDEuMTYtNC41OSAxLjczLTYuOTkgMS43M3YtMTI4LjU2bDk5LjA4LTYyLjEzLjA0LjA0YzEuNDQgMi4zMyAyLjI1IDUuMDcgMi4yNSA3LjkyeiIgZmlsbD0iI2ZmYjQ1NCIvPjxwYXRoIGQ9Im01MTIgMjU2YzAgOC4yOS02LjcyIDE1LTE1IDE1aC0yOS42OGMtNy4zNyAxMDQuODgtOTEuNDQgMTg4Ljk1LTE5Ni4zMiAxOTYuMzJ2MjkuNjhjMCA4LjI5LTYuNzIgMTUtMTUgMTV2LTc0LjE2YzEwMC4yNyAwIDE4MS44NC04MS41NyAxODEuODQtMTgxLjg0cy04MS41Ny0xODEuODQtMTgxLjg0LTE4MS44NHYtNzQuMTZjOC4yOCAwIDE1IDYuNzIgMTUgMTV2MjkuNjhjMTA0Ljg4IDcuMzggMTg4Ljk1IDkxLjQ0IDE5Ni4zMiAxOTYuMzJoMjkuNjhjOC4yOCAwIDE1IDYuNzIgMTUgMTV6IiBmaWxsPSIjMmUyZTJlIi8+PC9nPjwvc3ZnPg=="},"design":{"board":"Python3-Noetic","graph":{"blocks":[{"id":"0001-57aefee0-1ea8-4639-9a30-8c2bf9636454","type":"basic.constant","data":{"name":"Frequency","value":"30.0","local":true},"position":{"x":662,"y":13}},{"id":"7672c15b-5402-4746-b962-568ac33a0b33","type":"basic.code","data":{"code":"import cv2 as cv\nimport numpy as np\nfrom time import sleep\nfrom utils.wires.wire_img import share_image, read_image\nfrom utils.wires.wire_str import read_string\nfrom utils.tools.freq_monitor import monitor_frequency\n\ndef loop(block_name, input_wires, output_wires, parameters, flags):\n\n    input_0 = read_image(input_wires[0])\n    output_0 = share_image(output_wires[0])\n\n    enabled = False\n    try:\n        enable_wire = read_string(input_wires[1])\n    except IndexError:\n        enabled = True\n    \n    required_frequency, update = float(parameters[0]), 1\n    control_data = np.array([0.0,0.03])\n    \n    if flags[0] == 1:\n        monitor_frequency(block_name, control_data, required_frequency, update)\n        \n    try:\n    \n        while True:\n        \n            if enabled or (update := bool(enable_wire.get()[0])):\n\n                img = input_0.get()\n        \n                if img is not None:\n        \n                    img2 = cv.cvtColor(img, cv.COLOR_BGR2GRAY)\n                    ret, thresh = cv.threshold(img2,60,255,cv.THRESH_BINARY)\n                    contours, hierarchy = cv.findContours(thresh, 1, 2)\n            \n                    # Find the biggest contour (if detected)\n                    if len(contours) > 0:\n                    \n                        cnt = max(contours, key=cv.contourArea)\n                        rect = cv.minAreaRect(cnt) # ( center (x,y), (width, height), angle of rotation )\n                        \n                        M = cv.moments(cnt)\n                        cx = int(M['m10']/M['m00'])\n                        cy = int(M['m01']/M['m00'])\n                        \n                        data = [cx, cy, rect[1][0], rect[1][1], rect[2]]\n                        to_write = np.array(data, dtype='<U6')\n                        \n                        # (x, y, width, height, angle of rotation)\n                        output_0.add(to_write)\n            \n                    control_data[0] += 1\n                        \n            sleep(control_data[1])\n            \n    except KeyboardInterrupt: \n    \n        input_0.release()\n        enable_wire.release()\n        output_0.release()","params":[{"name":"Frequency"}],"ports":{"in":[{"name":"Inp"},{"name":"E"}],"out":[{"name":"Out"}]},"size":{"width":"624px","height":"386px"}},"position":{"x":380,"y":172}},{"id":"836f0850-4f43-4c8b-bd4a-96e25fd7f953","type":"basic.input","data":{"name":"Inp"},"position":{"x":186,"y":295}},{"id":"9da6d683-2099-4b74-9be8-f90e02ae31a6","type":"basic.input","data":{"name":"E"},"position":{"x":188,"y":443}},{"id":"d29b38a8-e56b-4ee1-8eb5-acb85e19be79","type":"basic.output","data":{"name":"Out"},"position":{"x":1127,"y":372}}],"wires":[{"source":{"block":"0001-57aefee0-1ea8-4639-9a30-8c2bf9636454","port":"constant-out"},"target":{"block":"7672c15b-5402-4746-b962-568ac33a0b33","port":"Frequency"}},{"source":{"block":"836f0850-4f43-4c8b-bd4a-96e25fd7f953","port":"input-out"},"target":{"block":"7672c15b-5402-4746-b962-568ac33a0b33","port":"Inp"}},{"source":{"block":"9da6d683-2099-4b74-9be8-f90e02ae31a6","port":"input-out"},"target":{"block":"7672c15b-5402-4746-b962-568ac33a0b33","port":"E"}},{"source":{"block":"7672c15b-5402-4746-b962-568ac33a0b33","port":"Out"},"target":{"block":"d29b38a8-e56b-4ee1-8eb5-acb85e19be79","port":"output-in"}}]}},"dependencies":{}}